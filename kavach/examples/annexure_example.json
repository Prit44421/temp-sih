{
  "os": "ubuntu",
  "module": "network",
  "rules": [
    {
      "id": "ubuntu.network.disable-ipv6",
      "title": "Disable IPv6",
      "description": "Ensure IPv6 is disabled if not in use",
      "level": "basic",
      "platforms": ["ubuntu", "centos"],
      "check": {
        "type": "shell",
        "cmd": "sysctl net.ipv6.conf.all.disable_ipv6 | awk '{print $3}'",
        "expect": "1"
      },
      "remediate": {
        "type": "shell",
        "cmd": "sysctl -w net.ipv6.conf.all.disable_ipv6=1 && echo 'net.ipv6.conf.all.disable_ipv6=1' >> /etc/sysctl.conf"
      },
      "validate": {
        "type": "shell",
        "cmd": "sysctl net.ipv6.conf.all.disable_ipv6 | awk '{print $3}'",
        "expect": "1"
      },
      "rollback": {
        "type": "restore_checkpoint"
      }
    }
  ]
}
